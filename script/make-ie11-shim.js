const coreJsBuilder = require('core-js-builder')
const fs = require('fs')

const FEATURES_TO_POLYFILL=[
  'es6.promise',
  'es6.object.assign',
  'es6.object.is',
  'es6.array.from',
  'es6.array.of',
  'es6.array.find',
  'es6.array.find-index',
  'es7.array.includes',
  'es6.function.name',
  'es6.string.ends-with',
  'es6.string.includes',
  'es6.string.starts-with',
  'es6.symbol'
]
const OUTPUT_FILE = 'public/javascripts/ie11-polyfill.js'

console.log(`building ${OUTPUT_FILE} to polyfill the following features: ${FEATURES_TO_POLYFILL}`)

coreJsBuilder({
  modules: FEATURES_TO_POLYFILL,
  library: false,
  umd: false
}).then(code => {
  const contents = "//THIS FILE WAS AUTOGENERATED BY script/make-ie11-shim.js\n" + code
  fs.writeFile(OUTPUT_FILE, contents)
})